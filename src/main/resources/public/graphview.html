<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
    <title>Popoto Search</title>
    <link rel="stylesheet" href="../css/popoto/popoto.min.css">
</head>
<body class="ppt-body">

<header class="ppt-header">
    <span class="ppt-header-span">POPOTO JS</span>
</header>

<section class="ppt-section-main" style="height: 700px">
    <div class="ppt-section-header">
        <span class="ppt-header-span">Neo4j movie graph -</span> Results example
    </div>

    <!-- By default the graph is generated on the HTML element with
    ID "popoto-graph" If needed this id can be changed with
    property "popoto.graph.containerId" -->

    <div id="popoto-graph" class="ppt-div-graph">
        <!-- Graph is generated here-->
    </div>

    <!-- By default the query viewer is generated on the HTML element
    with ID "popoto-query" If needed this id can be changed with
    property "popoto.query.containerId" -->

    <div id="popoto-query" class="ppt-container-query">
        <!-- Query viewer is generated here -->
    </div>

    <!-- Add a header with total number of results count -->
    <div class="ppt-section-header">
        RESULTS <span id="rescount" class="ppt-count"></span>
    </div>

    <!-- By default the result list is generated on the HTML element
    with ID "popoto-results" If needed this id can be changed with
    property "popoto.result.containerId" -->

    <div id="popoto-results" class="ppt-container-results">
        <!-- Results are generated here -->
    </div>

</section>

<!-- Required scripts -->
<script src="../js/jquery-2.1.0.min.js" charset="utf-8"></script>
<script src="../js/d3.v3.min.js" charset="utf-8"></script>
<script src="../js/popoto.min.js" charset="utf-8"></script>
<script>



// Define the list of label provider to customize the graph behavior:
// Only two labels are used in Neo4j movie graph example: "Movie" and Person

popoto.rest.CYPHER_URL = "bolt://127.0.0.1:7688";

popoto.provider.nodeProviders = {
    "Person": {
        "returnAttributes": ["Name", "Date of Birth", "Id"],
        "constraintAttribute": "title",
        "getDisplayType": function (node) {
            return popoto.provider.NodeDisplayTypes.IMAGE;
        },
        <!--"getImagePath": function (node) {-->
            <!--if (node.type === popoto.graph.node.NodeTypes.VALUE) {-->
                <!--return "movies/" +-->
                <!--node.attributes.title.replace("/", " ") + ".jpg";-->
            <!--} else {-->
                <!--if (node.value !== undefined) {-->
                    <!--return "movies/" +-->
                    <!--node.value.attributes.title.replace("/", " ") + ".jpg";-->
                <!--} else {-->
                    <!--if (node.type === popoto.graph.node.NodeTypes.ROOT) {-->
                        <!--return "movies/movie_blue.svg";-->
                    <!--} else {-->
                        <!--return "movies/movie_green.svg";-->
                    <!--}-->
                <!--}-->
            <!--}-->
        <!--},-->
        // Disable text on nodes as images are used instead.
        "getIsTextDisplayed": function (node) {
            return false;
        }
    }
    ,
        // Customize result display for Person nodes:
        "displayResults": function (pResultElmt) {

            // Here D3.js mechanisms is used to generate HTML code.
            // By default Popoto.js generates a <p> element
            // for each result.
            // pResultElmt parameter is the <p> element
            // selected with D3.js

            var div1 = pResultElmt.append("div")
                .attr("style", "display: flex;");
            div1.append("img")
                    .attr("height", "100")
                    .attr("width", "68")
                    .attr("src", function (result) {
                        return "persons/" + result.attributes.name + ".jpg";
                    });

            var div = div1.append("div").attr("style", "margin-left: 20px;");
            // An <h3> element containing the person name
            div.append("h3")
                    .text(function (result) {
                        return result.attributes.name;
                    });

            // A <span> element with the computed age from born attribute
            div.filter(function (result) {
                // Filter on attribute having born attribute value
                return result.attributes.born;
            }).append("span").text(function (result) {
                return "Age: " + (
                       new Date().getFullYear() - result.attributes.born);
            });

        }

};


</script>
</body>
</html>